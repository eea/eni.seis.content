<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">

<body>

<tal:col metal:fill-slot="portlets_one_slot"></tal:col>
<tal:col metal:fill-slot="portlets_two_slot"></tal:col>

<metal:main fill-slot="main">
  <div id="indicator-container" tal:define="indicator python:context">
    <h1 id="parent-fieldname-title" class="documentFirstHeading" tal:content="indicator/Title">
      Title
    </h1>

    <div class="documentDescription" tal:content="indicator/Description">
      Summary
    </div>

    <div id="content-core">
      <div class="row">
        <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">

          <div id="themes-tags" tal:condition="python:indicator.topics">
            <span class="list-head">Topics:</span>
            <tal:topics tal:repeat="topic python:indicator.topics">
            <span>
              <a class="link-category" rel="tag"
                 tal:attributes="href python:'/@@search?Subject%3Alist=' + topic"
                 tal:content="topic">
                Topic 1
              </a>
            </span>
            </tal:topics>
          </div>

          <div class="key-messages">
            <h3>Key messages</h3>
            <p tal:replace="structure python:indicator.key_messages.output">Key messages</p>
          </div>

          <div tal:replace="structure python:indicator.text.output">Body text</div>

          <tal:figures>
            <div class="eni-figure" tal:repeat="figure python:view.figures()">
              <h3 tal:content="python:figure['title']"></h3>

              <div tal:condition="python:figure['valid'] is True">
                <!-- Nav tabs -->
                <ul class="nav nav-tabs" role="tablist">
                  <li role="presentation">
                    <a tal:attributes="href python:'#' + figure['ids'][0]; aria-controls python:figure['ids'][0]"
                       role="tab" data-toggle="tab">Chart
                    </a>
                  </li>
                  <li role="presentation">
                    <a tal:attributes="href python:'#' + figure['ids'][1]; aria-controls python:figure['ids'][1]"
                       role="tab" data-toggle="tab">Table
                    </a>
                  </li>
                </ul>

                <!-- Tab panes -->
                <div class="tab-content">
                  <div role="tabpanel" class="tab-pane active" tal:attributes="id python:figure['ids'][0]">
                    <iframe width='1172' height='680'
                            tal:attributes="src python:figure['url'] + '/embed-chart?chart=' + figure['chart_id']">
                  </iframe>
                  </div>
                  <div role="tabpanel" class="tab-pane" tal:attributes="id python:figure['ids'][1]">
                    <iframe width='1172' height='680'
                            tal:attributes="src python:figure['url'] + '/download.table'">
                    </iframe>
                  </div>
                </div>
              </div>

              <div tal:condition="python:figure['valid'] is False">
                <span tal:replace="python:figure['url']"></span> is not valid.
                Chart ID: <span tal:content="python:figure['chart_id']"></span>
              </div>

            </div>
          </tal:figures>

          <!-- <div class="image&#45;container"> -->
          <!--   <tal:block replace="structure indicator/@@images/image" /> -->
          <!--   <p class="image&#45;caption">Image caption</p> -->
          <!-- </div> -->

          <!-- <h3 class="eni&#45;section&#45;title">Indicator Specification</h3> -->
          <!-- <h4>Indicator definition</h4> -->
          <!-- <p>Foo bar</p> -->
        </div>
      </div>

      <div class="row metadata-container">
        <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12">
          <h3>Generic metadata</h3>
          <p>
            <b>Topics:</b>
            <tal:topics tal:repeat="topic python:indicator.topics">
            <span>
              <a class="link-category" rel="tag"
                 tal:attributes="href python:'/@@search?Subject%3Alist=' + topic"
                 tal:content="topic">
                Topic 1
              </a>
            </span>
            </tal:topics>
          </p>
          <p tal:condition="python:indicator.indicator_code">
            <b>Indicator code:</b> <span tal:content="python:indicator.indicator_code">C2</span>
          </p>
          <p>
            <b>Tags:</b>
            <tal:topics tal:repeat="tag python:indicator.subject">
            <span>
              <a class="link-category" rel="tag"
                 tal:attributes="href python:'/@@search?Subject%3Alist=' + tag"
                 tal:content="tag">
                Topic 1
              </a>
            </span>
            </tal:topics>
          </p>

          <p tal:condition="python:indicator.temporal_coverage">
            <b>Temporal coverage:</b> <span tal:content="python:indicator.temporal_coverage">1971-2000</span>
          </p>

          <p tal:condition="python:indicator.dpsir">
            <b>DPSIR:</b> <span tal:content="python:indicator.dpsir">Response</span>
          </p>

          <p tal:condition="python:indicator.typology">
            <b>Typology:</b> <span tal:content="python:indicator.typology">Descriptive indicator</span>
          </p>

          <h3>Contact and ownership</h3>
          <p tal:condition="python:indicator.contact">
            <b>Contact:</b> <span tal:content="structure python:indicator.contact.output">Name 1, Name 2</span>
          </p>
          <p tal:condition="python:indicator.ownership">
            <b>Ownership:</b> <span tal:content="structure python:indicator.ownership.output">Institute of Ecology</span>
          </p>
        </div>

        <div class="col-lg-6 col-md-6 col-sm-12 col-xs-12"
          tal:define="publish_date python:indicator.EffectiveDate();
                      modification_date python:indicator.ModificationDate();
                      plone_view indicator/@@plone;">
          <h3>Dates</h3>
          <p>
            <b>Publish date:</b>
            <span tal:replace="python:' %s' % plone_view.toLocalizedTime(publish_date)"> August 16, 2001 at 23:35:59</span>
          </p>
          <p>
            <b>Last modified:</b>
            <span tal:replace="python:' %s' % plone_view.toLocalizedTime(modification_date)"> August 16, 2001 at 23:35:59</span>
          </p>
          <p tal:condition="python:indicator.frecvency_of_updates">
            <b>Frequency of updates:</b>
            <span tal:content="python:indicator.frecvency_of_updates">every year</span>
          </p>

          <h3>Related content:</h3>
          <p tal:condition="python:indicator.related_content">
            <span tal:replace="structure python:indicator.related_content.output">related</span>
          </p>
        </div>
      </div>
    </div>
  </div>

<!-- <script> -->
<!-- $("document").ready(function() { -->
<!--   debugger; // TODO WIP fix table styles -->
<!--   $('iframe').load( function() { -->
<!--     $('iframe').contents().find("head") -->
<!--       .append($("<style type='text/css'>  body {background: red !important;}  </style>")); -->
<!--   }); -->
<!-- }); -->
<!-- </script> -->

<style>

body.template-view.portaltype-indicatordata div.page-main {
  width: 100%;
}
body.template-view.portaltype-indicatordata div.page-main div#themes-tags {
  margin-top: 2em;
}

body.template-view.portaltype-indicatordata div.page-main div#themes-tags a.link-category,
body.template-view.portaltype-indicatordata div.page-main div.metadata-container a.link-category {
  color: black !important;
  padding: 2px 6px;
  margin: 2px 0;
  word-break: keep-all;
  display: inline-block;
  line-height: inherit;
  background: #eaeaea;
  font-size: 12px;
}

body.template-view.portaltype-indicatordata div.page-main div#themes-tags a.link-category:hover,
body.template-view.portaltype-indicatordata div.page-main div.metadata-container a.link-category:hover {
  color: white !important;
  background: #1f87e8;
}

body.template-view.portaltype-indicatordata div.page-main div#themes-tags span.list-head {
  font-weight: 500;
}

body.template-view.portaltype-indicatordata div.page-main div.key-messages {
  margin-top: 2em;
  margin-bottom: 2em;
  padding: 20px;
  background: #F8F8F8;
  border-left: 1em solid #1f87e8;
}

body.template-view.portaltype-indicatordata div.page-main div.key-messages h3 {
  margin-top: 1em;
}

body.template-view.portaltype-indicatordata div.page-main div.image-container {
  padding: 20px;
  width: 100%;
  text-align: center;
  border: 1px solid #eaeaea;
  margin-bottom: 20px;
}

body.template-view.portaltype-indicatordata div.page-main div.image-container img {
  margin: 20px;
}

body.template-view.portaltype-indicatordata div.page-main div.image-container p.image-caption {
  text-align: left;
  background: #F8F8F8;
  border-left: 1em solid #737373;
  padding: 20px;
  margin-bottom: 0px !important;
}

body.template-view.portaltype-indicatordata div.page-main ul li {
  list-style: square;
}

body.template-view.portaltype-indicatordata div.page-main h3 {
  margin-top: 2em;
}

body.template-view.portaltype-indicatordata div.page-main h4 {
  margin-top: 1em;
}

body.template-view.portaltype-indicatordata div.page-main div.row.metadata-container {
  background: #F8F8F8;
  border: 1px solid #eaeaea;
  border-top: 1em solid #1f87e8;
  padding: 20px;
  margin-top: 3em;
}

body.template-view.portaltype-indicatordata div.page-main div.metadata-container h3 {
  border-bottom: 1px solid #737373;
}

body.template-view.portaltype-indicatordata div.eni-figure .nav-item > a {
  margin-left: initial;
  margin-right: initial;
}

</style>
</metal:main>

</body>
</html>
