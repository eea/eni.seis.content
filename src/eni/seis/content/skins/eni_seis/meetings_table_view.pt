<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">

<body>

  <metal:content-core fill-slot="content-core">

    <metal:block define-macro="listing" extend-macro="context/folder_listing/macros/content-core">

      <metal:entries fill-slot="long_description"></metal:entries>

      <metal:entries fill-slot="entries">

        <div tal:replace="structure tab/long_description | nothing" tal:on-error="nothing"></div>

        <table class="listing event-table"
               summary="Content listing"
               i18n:attributes="summary summary_content_listing;">
          <thead>
            <tr>
              <th>Event</th>
              <th>Date</th>
            </tr>
          </thead>

          <tbody>
            <metal:block use-macro="context/folder_listing/macros/entries">
              <metal:entry fill-slot="entry">

                <tr metal:define-macro="listitem" tal:define="oddrow repeat/item/odd;"
                    tal:attributes="class python:test(oddrow, 'even', 'odd')">

                  <td>
                    <div class="event-title">
                      <a href="" tal:attributes="href item/getURL" tal:content="item/Title">Item</a>
                    </div>

                    <div class="event-location">
                      <strong>Location:</strong>
                      <span tal:replace="python: context.get_event_location(item)"></span>
                    </div>

                    <div class="event-category">
                      <strong>Category:</strong>
                      <span tal:replace="python: context.get_event_type(item).capitalize()"></span>
                    </div>

                    <div tal:define="obj item/getObject" class="event-contact">
                      <strong>Contact:</strong>
                      <tal:condition tal:condition="python: hasattr(obj, 'contact_email') and hasattr(obj, 'contact_name')">
                        <a href="" tal:attributes="href python: obj.contact_email" tal:content="python: obj.contact_name">Somebody</a>
                      </tal:condition>
                    </div>

                    <div>

                      <form tal:attributes="action string:${item/getURL}/register" method="GET">

                        <div>
                          <label for="form-widgets-reimbursed">
                              Reimbursed participation
                          </label>

                          <span class="option">
                            <label for="form-widgets-reimbursed-0">
                              <input id="form-widgets-reimbursed" name="form.widgets.reimbursed" class="radio-widget required bool-field"
                                     value="true" type="radio">
                                  <span class="label">yes</span>
                            </label>
                          </span>

                          <span class="option">
                            <label for="form-widgets-reimbursed-1">
                              <input id="form-widgets-reimbursed-1" name="form.widgets.reimbursed" class="radio-widget required bool-field"
                                     value="false" checked="checked" type="radio">
                              <span class="label">no</span>
                            </label>
                          </span>
                        </div>

                        <div>
                          <label for="form-widgets-role">
                            Role
                          </label>
                          <select id="form-widgets-role" name="form.widgets.role:list" class="select-widget required choice-field" size="1">
                            <!-- [TODO] Get values from subscriber_role vocabulary -->
                            <option id="form-widgets-role-0" value="medpol-nfp" selected="selected">MedPOL NFP</option>
                            <option id="form-widgets-role-1" value="other">Other</option>
                            <option id="form-widgets-role-2" value="h2020-nfp">H2020 NFP</option>
                            <option id="form-widgets-role-3" value="eni-seis-ii-east-nfp">ENI-SEIS II EAST NFP</option>
                          </select>

                          <input class="btn event-register" type="submit" name="event-register" value="Register" />
                        </div>
                      </form>
                    </div>
                  </td>

                  <td class="event-table-date">
                    <tal:condition tal:condition="python: context.get_event_year(item) and context.get_event_dates(item)">
                      <span tal:content="python: context.get_event_year(item)">
                      </span> / <span tal:content="python:context.get_event_dates(item)"></span>
                    </tal:condition>
                  </td>

                </tr>

              </metal:entry>
            </metal:block>
          </tbody>
        </table>

        <div tal:on-error="nothing" tal:condition="python: not context.portal_membership.isAnonymousUser()">
          <form method="GET" action="" tal:attributes="action string:${tab/absolute_url}/++add++eea.meeting">
            <button type="submit" class="btn btn-default">Create a new Meeting</button>
          </form>
        </div>
      </metal:entries>
    </metal:block>

    <metal:subtopics use-macro="context/atct_topic_view/macros/folderlisting_macro" />

  </metal:content-core>

</body>
</html>
